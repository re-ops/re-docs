<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Introduction</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <link rel="preload" href="/re-docs/assets/css/0.styles.e90edc39.css" as="style"><link rel="preload" href="/re-docs/assets/js/app.3c78d9e2.js" as="script"><link rel="preload" href="/re-docs/assets/js/2.ec02657a.js" as="script"><link rel="preload" href="/re-docs/assets/js/6.e571e6b8.js" as="script"><link rel="prefetch" href="/re-docs/assets/js/10.8bf83368.js"><link rel="prefetch" href="/re-docs/assets/js/11.4abe2119.js"><link rel="prefetch" href="/re-docs/assets/js/12.5dafd2bf.js"><link rel="prefetch" href="/re-docs/assets/js/13.5b65ea41.js"><link rel="prefetch" href="/re-docs/assets/js/14.f1524c7a.js"><link rel="prefetch" href="/re-docs/assets/js/15.0ca0d919.js"><link rel="prefetch" href="/re-docs/assets/js/3.45a93981.js"><link rel="prefetch" href="/re-docs/assets/js/4.3bffaa85.js"><link rel="prefetch" href="/re-docs/assets/js/5.670ca218.js"><link rel="prefetch" href="/re-docs/assets/js/7.60ea2338.js"><link rel="prefetch" href="/re-docs/assets/js/8.30ef28fa.js"><link rel="prefetch" href="/re-docs/assets/js/9.b2e5dc3d.js">
    <link rel="stylesheet" href="/re-docs/assets/css/0.styles.e90edc39.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/re-docs/" aria-current="page" class="home-link router-link-exact-active router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Basics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/re-docs/" aria-current="page" class="active sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/#motivation" class="sidebar-link">Motivation</a></li><li class="sidebar-sub-header"><a href="/re-docs/#why-clojure" class="sidebar-link">Why Clojure</a></li><li class="sidebar-sub-header"><a href="/re-docs/#abstractions" class="sidebar-link">Abstractions</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Quickstart</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/re-docs/quickstart/" class="sidebar-link">Intro</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/quickstart/#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/re-docs/quickstart/#image" class="sidebar-link">Image</a></li><li class="sidebar-sub-header"><a href="/re-docs/quickstart/#elasticsearch" class="sidebar-link">Elasticsearch</a></li><li class="sidebar-sub-header"><a href="/re-docs/quickstart/#launch" class="sidebar-link">Launch</a></li><li class="sidebar-sub-header"><a href="/re-docs/quickstart/#run" class="sidebar-link">Run</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Setup</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/re-docs/setup/" class="sidebar-link">Intro</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/setup/#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/#elk" class="sidebar-link">ELK</a></li></ul></li><li><a href="/re-docs/setup/configuration.html" class="sidebar-link">Configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/setup/configuration.html#secret-management" class="sidebar-link">Secret management</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/configuration.html#shared" class="sidebar-link">Shared</a></li></ul></li><li><a href="/re-docs/setup/re-core.html" class="sidebar-link">Re-core</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/setup/re-core.html#setup" class="sidebar-link">Setup</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-core.html#templates" class="sidebar-link">Templates</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-core.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-core.html#hypervisors" class="sidebar-link">Hypervisors</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/setup/re-core.html#aws" class="sidebar-link">AWS</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-core.html#digitalocean" class="sidebar-link">Digitalocean</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-core.html#kvm" class="sidebar-link">KVM</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-core.html#lxc" class="sidebar-link">LXC</a></li></ul></li></ul></li><li><a href="/re-docs/setup/re-mote.html" class="sidebar-link">Re-mote</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/setup/re-mote.html#setup" class="sidebar-link">Setup</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-mote.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-mote.html#ssh" class="sidebar-link">SSH</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-mote.html#publishing" class="sidebar-link">Publishing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/setup/re-mote.html#riemann" class="sidebar-link">Riemann</a></li></ul></li></ul></li><li><a href="/re-docs/setup/re-gent.html" class="sidebar-link">Re-gent</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/setup/re-gent.html#build" class="sidebar-link">Build</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-gent.html#deploy" class="sidebar-link">Deploy</a></li></ul></li><li><a href="/re-docs/setup/re-dock.html" class="sidebar-link">Re-dock</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/setup/re-dock.html#run" class="sidebar-link">Run</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-dock.html#dashboards" class="sidebar-link">Dashboards</a></li></ul></li><li><a href="/re-docs/setup/re-pack.html" class="sidebar-link">Re-pack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/setup/re-pack.html#build" class="sidebar-link">Build</a></li><li class="sidebar-sub-header"><a href="/re-docs/setup/re-pack.html#deploy" class="sidebar-link">Deploy</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Usage</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/re-docs/usage/" class="sidebar-link">Intro</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/usage/#reloaded" class="sidebar-link">Reloaded</a></li><li class="sidebar-sub-header"><a href="/re-docs/usage/#re-core" class="sidebar-link">Re-core</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/usage/#presets" class="sidebar-link">Presets</a></li></ul></li><li class="sidebar-sub-header"><a href="/re-docs/usage/#re-mote" class="sidebar-link">Re-mote</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/usage/#functions" class="sidebar-link">Functions</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Architecture</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/re-docs/architecture/" class="sidebar-link">Components</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/re-docs/architecture/#networking" class="sidebar-link">Networking</a></li><li class="sidebar-sub-header"><a href="/re-docs/architecture/#security" class="sidebar-link">Security</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h1> <p>Re-ops is a Clojure based live REPL environment for performing VM orchestration and remote operations, it offers high development speed and flexibility.</p> <p>Its main components include:</p> <ol><li>Re-core, orchestration of Virtual and Physical machines.</li> <li>Re-mote, performing remote operations over SSH and ZeroMQ.</li> <li>Re-gent, an agent for running distributed Clojure functions.</li></ol> <h2 id="motivation"><a href="#motivation" class="header-anchor">#</a> Motivation</h2> <p>Most (if not all) configuration management tools currently are static in nature, you write your code deploy and apply (rinse and repeat), still our live environments are changing rapidly and having this cycle in place really slows our reaction time down, Re-ops is a re-take on how remote operations would look like when using a live REPL to drive them, its main abstractions include pipelines and operations that are easy to compose because they are just plain functions.</p> <h2 id="why-clojure"><a href="#why-clojure" class="header-anchor">#</a> Why Clojure</h2> <p>Re-ops encompasses the functionality of multiple tools, ranging from remote automation to data collection and VM orchestration.</p> <p>Most existing tools need to re-invent:</p> <ul><li>Namespaces, a way of dividing the code into components.</li> <li>Composition, how you compose reusable code.</li> <li>Packaging, how the code is distributed, how you use external libraries.</li> <li>Interoperability, how you interop with external components and systems.</li></ul> <p>By using Clojure we gain a lot those things for free:</p> <ul><li>Namespace packaging are built in.</li> <li>Composition is first class (using functional composition, protocols etc..)</li> <li>We can use any JVM library (or write our own) to integrate with other components.</li></ul> <p>But the biggest advantage is the that Clojure is really geared toward processing transforming and analysing data which is abundantly available when dealing with computerized systems.</p> <h2 id="abstractions"><a href="#abstractions" class="header-anchor">#</a> Abstractions</h2> <p>Both Re-mote and Re-core use similar patterns to describe workflows and operations that work against remote systems and hypervisors, the first one is pipelines:</p> <ul><li>A Series of functions (operations)</li> <li>Data flows from one function to the next</li> <li>Intermediate functions operate on data</li> <li>Final function output, publish, block/run async etc..</li> <li>They are composable (just functions)</li></ul> <div class="language-clojure extra-class"><pre class="language-clojure"><code>
                            filtering             output
                                ^                   ^
<span class="token punctuation">(</span><span class="token keyword">defn</span> listing <span class="token punctuation">[</span>hs<span class="token punctuation">]</span>              |                   |
  <span class="token punctuation">(</span>run <span class="token punctuation">(</span>ls hs <span class="token string">&quot;/&quot;</span> <span class="token string">&quot;-la&quot;</span><span class="token punctuation">)</span> | <span class="token punctuation">(</span>pick successful<span class="token punctuation">)</span> | <span class="token punctuation">(</span>pretty<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   |                     |
   |                     V
   |       <span class="token punctuation">[</span>this<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token operator">:successful</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">:failure</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
   V

<span class="token comment">; run expansion</span>
<span class="token punctuation">(</span>| <span class="token punctuation">(</span>| <span class="token punctuation">(</span>ls <span class="token keyword">..</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>pick <span class="token keyword">..</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>pretty<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">; pipe expansion</span>
<span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>this' res<span class="token punctuation">]</span> <span class="token punctuation">(</span>ls hs<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">(</span>pick this' res<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>The second set of abstractions include the Hosts record in Re-mote:</p> <div class="language-clojure extra-class"><pre class="language-clojure"><code><span class="token punctuation">(</span><span class="token keyword">defrecord</span> Hosts <span class="token punctuation">[</span>auth hosts<span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre></div><p>Which represents a collection of hosts and the ssh authentication information require to login into them,  we add new operation on hosts by extending them with protocols:</p> <div class="language-clojure extra-class"><pre class="language-clojure"><code><span class="token punctuation">(</span><span class="token keyword">defprotocol</span> Pkg
  <span class="token punctuation">(</span>update
    <span class="token punctuation">[</span>this<span class="token punctuation">]</span>
    <span class="token punctuation">[</span>this m<span class="token punctuation">]</span><span class="token punctuation">)</span>
     <span class="token keyword">..</span>.<span class="token keyword">.</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span>extend-type Hosts
  Pkg
  <span class="token punctuation">(</span>update <span class="token punctuation">[</span>this<span class="token punctuation">]</span>
     <span class="token comment">; updating packages</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">..</span>.
  <span class="token punctuation">)</span>
</code></pre></div><p>By using protocols this way we gain infinite expansion options, similarly Re-core Systems and Types use a similar scheme:</p> <div class="language-clojure extra-class"><pre class="language-clojure"><code><span class="token punctuation">(</span><span class="token keyword">defrecord</span> Systems <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token keyword">defrecord</span> Types <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>Both Systems (VMs, containers or physical machines) and Types (System provision info) are composed of a set of protocols that are used from pipelines:</p> <div class="language-clojure extra-class"><pre class="language-clojure"><code><span class="token punctuation">(</span><span class="token keyword">defprotocol</span> Jobs
  <span class="token string">&quot;System jobs&quot;</span>
  <span class="token punctuation">(</span>stop <span class="token punctuation">[</span>this items<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>start <span class="token punctuation">[</span>this items<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>create <span class="token punctuation">[</span>this items<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>provision <span class="token punctuation">[</span>this items<span class="token punctuation">]</span><span class="token punctuation">)</span>
   <span class="token keyword">..</span>.
  <span class="token punctuation">)</span>

<span class="token punctuation">(</span>extend-type Systems
  Jobs
  <span class="token punctuation">(</span>stop <span class="token punctuation">[</span>this <span class="token punctuation">{</span><span class="token operator">:keys</span> <span class="token punctuation">[</span>systems<span class="token punctuation">]</span> <span class="token operator">:as</span> m<span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span>this <span class="token punctuation">(</span>schedule m <span class="token string">&quot;stop&quot;</span> systems<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token punctuation">(</span>start <span class="token punctuation">[</span>this <span class="token punctuation">{</span><span class="token operator">:keys</span> <span class="token punctuation">[</span>systems<span class="token punctuation">]</span> <span class="token operator">:as</span> m<span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span>this <span class="token punctuation">(</span>schedule m <span class="token string">&quot;start&quot;</span> systems<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token punctuation">(</span>create <span class="token punctuation">[</span>this <span class="token punctuation">{</span><span class="token operator">:keys</span> <span class="token punctuation">[</span>systems<span class="token punctuation">]</span> <span class="token operator">:as</span> m<span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span>this <span class="token punctuation">(</span>schedule m <span class="token string">&quot;create&quot;</span> systems<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">..</span>.
  <span class="token punctuation">)</span>

</code></pre></div><p>Just like Re-mote Hosts type we compose operations into pipelines:</p> <div class="language-clojure extra-class"><pre class="language-clojure"><code><span class="token punctuation">(</span><span class="token keyword">defn</span> <span class="token keyword">list</span>
  <span class="token string">&quot;List available instances:
    (list) ; list all systems
    (list ip) ; list all systems that have an ip (running)
    (list identity :types) ; list all types
  &quot;</span>
  <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
   <span class="token punctuation">(</span><span class="token keyword">list</span> <span class="token keyword">identity</span> <span class="token operator">:systems</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">f</span><span class="token punctuation">]</span>
   <span class="token punctuation">(</span><span class="token keyword">list</span> <span class="token number">f</span> <span class="token operator">:systems</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">f</span> on<span class="token punctuation">]</span>
   <span class="token punctuation">(</span>case on
     <span class="token operator">:systems</span> <span class="token punctuation">(</span>run <span class="token punctuation">(</span>ls systems<span class="token punctuation">)</span> | <span class="token punctuation">(</span>filter-by <span class="token number">f</span><span class="token punctuation">)</span> | <span class="token punctuation">(</span>pretty<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token operator">:types</span> <span class="token punctuation">(</span>run <span class="token punctuation">(</span>ls types<span class="token punctuation">)</span> | <span class="token punctuation">(</span>pretty<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/re-docs/quickstart/">
        Intro
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/re-docs/assets/js/app.3c78d9e2.js" defer></script><script src="/re-docs/assets/js/2.ec02657a.js" defer></script><script src="/re-docs/assets/js/6.e571e6b8.js" defer></script>
  </body>
</html>
