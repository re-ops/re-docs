
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Introduction Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="./" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter active" data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="./">
            
                <a href="./#motivation">
            
                    
                    Motivation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="./">
            
                <a href="./#why-clojure">
            
                    
                    Why Clojure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="./">
            
                <a href="./#abstractions">
            
                    
                    Abstractions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="setup/">
            
                <a href="setup/">
            
                    
                    Setup
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="setup/">
            
                <a href="setup/#prerequisites">
            
                    
                    Perquisites
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#intro">
            
                    
                    Re-core
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.2.1" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#_setup">
            
                    
                    Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.2" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#_templates">
            
                    
                    Templates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.3" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#_configuration">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.4" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#_hypervisors">
            
                    
                    Hypervisors
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.2.4.1" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#_aws">
            
                    
                    AWS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.4.2" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#_digitalocean">
            
                    
                    Digitalocean
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.4.3" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#_kvm">
            
                    
                    KVM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.4.4" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#_kvm_libvirt">
            
                    
                    Libvirt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.4.5" data-path="setup/re-core.html">
            
                <a href="setup/re-core.html#_support_matrix">
            
                    
                    Support matix
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="setup/re-mote.html">
            
                <a href="setup/re-mote.html#intro">
            
                    
                    Re-mote
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.3.1" data-path="setup/re-mote.html">
            
                <a href="setup/re-mote.html#setup">
            
                    
                    Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.2" data-path="setup/re-mote.html">
            
                <a href="setup/re-mote.html#configuration">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.3" data-path="setup/re-mote.html">
            
                <a href="setup/re-mote.html#keys">
            
                    
                    Keys
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="setup/re-gent.html">
            
                <a href="setup/re-gent.html#intro">
            
                    
                    Re-gent
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.4.1" data-path="setup/re-gent.html">
            
                <a href="setup/re-gent.html#build">
            
                    
                    Build
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.2" data-path="setup/re-gent.html">
            
                <a href="setup/re-gent.html#deploy">
            
                    
                    Deploy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="setup/re-dock.html">
            
                <a href="setup/re-dock.html#intro">
            
                    
                    Re-dock
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.1" data-path="setup/re-dock.html">
            
                <a href="setup/re-dock.html#run">
            
                    
                    Run
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.2" data-path="setup/re-dock.html">
            
                <a href="setup/re-dock.html#dashboards">
            
                    
                    Dashboards
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.6" data-path="setup/re-pack.html">
            
                <a href="setup/re-pack.html#intro">
            
                    
                    Re-pack
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.6.1" data-path="setup/re-pack.html">
            
                <a href="setup/re-pack.html#build">
            
                    
                    Build
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.6.2" data-path="setup/re-pack.html">
            
                <a href="setup/re-pack.html#deploy">
            
                    
                    Deploy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="usage/">
            
                <a href="usage/">
            
                    
                    Usage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="usage/">
            
                <a href="usage/#reloaded">
            
                    
                    Reloaded
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="usage/">
            
                <a href="usage/#re-core">
            
                    
                    Re-core
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="usage/">
            
                <a href="usage/#re-mote">
            
                    
                    Re-mote
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.3.1" data-path="usage/">
            
                <a href="usage/#functions">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="usage/">
            
                <a href="usage/#scheduling">
            
                    
                    Scheduling
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="architecture/">
            
                <a href="architecture/">
            
                    
                    Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="architecture/">
            
                <a href="architecture/#components">
            
                    
                    Components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="architecture/">
            
                <a href="architecture/#networking">
            
                    
                    Networking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="architecture/">
            
                <a href="architecture/#security">
            
                    
                    Security
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Introduction</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="introduction">Introduction</h1>
<p>Re-ops is a Clojure based live REPL environment for performing VM orchestration and remote operations, it offers high development speed and flexibility.</p>
<p>Its main components include:</p>
<ol>
<li>Re-core, orchestration of Virtual and Physical machines.</li>
<li>Re-mote, performing remote operations over SSH and ZeroMQ.</li>
<li>Re-gent, an agent for running distributed Clojure functions.</li>
</ol>
<h2 id="motivation">Motivation</h2>
<p>Most (if not all) configuration management tools currently are static in nature, you write your code deploy and apply (rinse and repeat), still our live environments are changing rapidly and having this cycle in place really slows our reaction time down, Re-ops is a re-take on how remote operations would look like when using a live REPL to drive them, its main abstractions include pipelines and operations that are easy to compose because they are just plain functions.</p>
<h2 id="why-clojure">Why Clojure</h2>
<p>Re-ops encompasses the functionality of multiple tools, ranging from remote automation to data collection and VM orchestration.</p>
<p>Most existing tools need to re-invent:</p>
<ul>
<li>Namespaces, a way of dividing the code into components.</li>
<li>Composition, how you compose reusable code.</li>
<li>Packaging, how the code is distributed, how you use external libraries.</li>
<li>Interoperability, how you interop with external components and systems.</li>
</ul>
<p>By using Clojure we gain a lot those things for free:</p>
<ul>
<li>Namespace packaging are built in.</li>
<li>Composition is first class (using functional composition, protocols etc..)</li>
<li>We can use any JVM library (or write our own) to integrate with other components.</li>
</ul>
<p>But the biggest advantage is the that Clojure is really geared toward processing transforming and analysing data which is abundantly available when dealing with computerized systems.</p>
<h2 id="abstractions">Abstractions</h2>
<p>Both Re-mote and Re-core use similar patterns to describe workflows and operations that work against remote systems and hypervisors, the first one is pipelines:</p>
<ul>
<li>A Series of functions (operations)</li>
<li>Data flows from one function to the next</li>
<li>Intermediate functions operate on data</li>
<li>Final function output, publish, block/run async etc..</li>
<li>They are composable (just functions)</li>
</ul>
<pre><code class="lang-clojure">
                            filtering             output
                                ^                   ^
(defn listing [hs]              |                   |
  (run (ls hs &quot;/&quot; &quot;-la&quot;) | (pick successful) | (pretty)))
   |                     |
   |                     V
   |       [this, {:successful [], :failure []}
   V

; run expansion
(| (| (ls ..) (pick ..)) (pretty))

; pipe expansion
(let [[this&apos; res] (ls hs)]
  (pick this&apos; res))
</code></pre>
<p>The second set of abstractions include the Hosts record in Re-mote:</p>
<pre><code class="lang-clojure">(<span class="hljs-name"><span class="hljs-builtin-name">defrecord</span></span> Hosts [auth hosts])
</code></pre>
<p>Which represents a collection of hosts and the ssh authentication information require to login into them,  we add new operation on hosts by extending them with protocols:</p>
<pre><code class="lang-clojure">(<span class="hljs-name"><span class="hljs-builtin-name">defprotocol</span></span> Pkg
  (<span class="hljs-name">update</span>
    [this]
    [this m])
     ....)

(<span class="hljs-name"><span class="hljs-builtin-name">extend-type</span></span> Hosts
  Pkg
  (<span class="hljs-name">update</span> [this]
     <span class="hljs-comment">; updating packages</span>
    )
    ...
  )
</code></pre>
<p>By using protocols this way we gain infinite expansion options, similarly Re-core Systems and Types use a similar scheme:</p>
<pre><code class="lang-clojure">(<span class="hljs-name"><span class="hljs-builtin-name">defrecord</span></span> Systems [])
(<span class="hljs-name"><span class="hljs-builtin-name">defrecord</span></span> Types [])
</code></pre>
<p>Both Systems (VMs, containers or physical machines) and Types (System provision info) are composed of a set of protocols that are used from pipelines:</p>
<pre><code class="lang-clojure">(<span class="hljs-name"><span class="hljs-builtin-name">defprotocol</span></span> Jobs
  <span class="hljs-string">&quot;System jobs&quot;</span>
  (<span class="hljs-name">stop</span> [this items])
  (<span class="hljs-name">start</span> [this items])
  (<span class="hljs-name">create</span> [this items])
  (<span class="hljs-name">provision</span> [this items])
   ...
  )

(<span class="hljs-name"><span class="hljs-builtin-name">extend-type</span></span> Systems
  Jobs
  (<span class="hljs-name">stop</span> [this {<span class="hljs-symbol">:keys</span> [systems] <span class="hljs-symbol">:as</span> m}]
    [this (<span class="hljs-name">schedule</span> m <span class="hljs-string">&quot;stop&quot;</span> systems)])

  (<span class="hljs-name">start</span> [this {<span class="hljs-symbol">:keys</span> [systems] <span class="hljs-symbol">:as</span> m}]
    [this (<span class="hljs-name">schedule</span> m <span class="hljs-string">&quot;start&quot;</span> systems)])

  (<span class="hljs-name">create</span> [this {<span class="hljs-symbol">:keys</span> [systems] <span class="hljs-symbol">:as</span> m}]
    [this (<span class="hljs-name">schedule</span> m <span class="hljs-string">&quot;create&quot;</span> systems)])

    ...
  )
</code></pre>
<p>Just like Re-mote Hosts type we compose operations into pipelines:</p>
<pre><code class="lang-clojure">(<span class="hljs-name"><span class="hljs-builtin-name">defn</span></span> list
  <span class="hljs-string">&quot;List available instances:
    (list) ; list all systems
    (list ip) ; list all systems that have an ip (running)
    (list identity :types) ; list all types
  &quot;</span>
  ([]
   (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> identity <span class="hljs-symbol">:systems</span>))
  ([f]
   (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> f <span class="hljs-symbol">:systems</span>))
  ([f on]
   (<span class="hljs-name"><span class="hljs-builtin-name">case</span></span> on
     <span class="hljs-symbol">:systems</span> (<span class="hljs-name">run</span> (<span class="hljs-name">ls</span> systems) | (<span class="hljs-name">filter-by</span> f) | (<span class="hljs-name">pretty</span>))
     <span class="hljs-symbol">:types</span> (<span class="hljs-name">run</span> (<span class="hljs-name">ls</span> types) | (<span class="hljs-name">pretty</span>)))))
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="./#motivation" class="navigation navigation-next navigation-unique" aria-label="Next page: Motivation">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Introduction","level":"1.1","depth":1,"next":{"title":"Motivation","level":"1.1.1","depth":2,"anchor":"#motivation","path":"README.md","ref":"README.md#motivation","articles":[]},"dir":"ltr"},"config":{"plugins":["editlink","github","highlight","livereload"],"root":".","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"github":{"url":"https://github.com/re-ops/re-dock"},"editlink":{"label":"Edit This Page","multilingual":false,"base":"https://github.com/re-ops/re-dock/tree/master"},"livereload":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"README.md","mtime":"2018-03-13T12:20:30.718Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-03-19T06:11:21.020Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-editlink/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

